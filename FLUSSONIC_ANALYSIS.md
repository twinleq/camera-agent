# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—à–∏–≤–∫–∏ Flussonic Agent –¥–ª—è Dahua

## üì¶ –ß—Ç–æ –º—ã –Ω–∞—à–ª–∏ –≤ –ø—Ä–æ—à–∏–≤–∫–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—à–∏–≤–∫–∏ Dahua —Å Flussonic Agent:

```
TEMP_DH_IPC-HX2XXX-Molec_MultiLang_PN_V2.820.1015003.0.T.210928.bin (30MB)
‚îÇ
‚îú‚îÄ‚îÄ hwid (6.8KB)                    # –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ Install (367B)                  # –°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
‚îú‚îÄ‚îÄ kernel.img (2.5MB)              # –Ø–¥—Ä–æ Linux
‚îú‚îÄ‚îÄ dhboot.bin.img (314KB)          # –ó–∞–≥—Ä—É–∑—á–∏–∫
‚îú‚îÄ‚îÄ dhboot-min.bin.img (1.6MB)      # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–≥—Ä—É–∑—á–∏–∫
‚îú‚îÄ‚îÄ romfs-x.squashfs.img (19.7MB)   # ‚≠ê –û—Å–Ω–æ–≤–Ω–∞—è –§–° (–∑–¥–µ—Å—å –∞–≥–µ–Ω—Ç)
‚îú‚îÄ‚îÄ web-x.squashfs.img (7.4MB)      # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ partition-x.cramfs.img (8.6KB)  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ check.img (7.6KB)               # –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞
‚îî‚îÄ‚îÄ sign.img (128B)                 # –¶–∏—Ñ—Ä–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å
```

### –ü—Ä–æ—Ü–µ—Å—Å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (–∏–∑ Install —Å–∫—Ä–∏–ø—Ç–∞):

```json
{
   "Commands" : [
      "burn partition-x.cramfs.img partition",
      "burn kernel.img kernel",
      "burn romfs-x.squashfs.img rootfs",
      "burn web-x.squashfs.img web",
      "burn dhboot.bin.img bootloader",
      "burn dhboot-min.bin.img mini-boot"
   ]
}
```

## üîç –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

### 1. **–§–æ—Ä–º–∞—Ç –ø—Ä–æ—à–∏–≤–∫–∏**
- –ü—Ä–æ—à–∏–≤–∫–∞ Dahua –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ZIP –∞—Ä—Ö–∏–≤ —Å —Å–∏–≥–Ω–∞—Ç—É—Ä–æ–π `DH`
- –û—Å–Ω–æ–≤–Ω–∞—è –§–° –≤ SquashFS —Ñ–æ—Ä–º–∞—Ç–µ (read-only)
- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º SquashFS

### 2. **Flussonic Agent —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**
- –ê–≥–µ–Ω—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `romfs-x.squashfs.img` (19.7MB)
- –í–µ—Ä–æ—è—Ç–Ω—ã–µ –ø—É—Ç–∏:
  - `/usr/bin/flussonic-agent`
  - `/opt/flussonic/agent`
  - `/etc/init.d/flussonic-agent`

### 3. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞**: Linux ARM
- **–ß–∏–ø—Å–µ—Ç**: Mstar 327DE
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: ARMv7
- **–§–°**: SquashFS (read-only) + CRAMFS

## üéØ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Flussonic Agent (–Ω–∞—à–∞ –≥–∏–ø–æ—Ç–µ–∑–∞)

### –ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ—à–∏–≤–∫–∏:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    DAHUA –ö–ê–ú–ï–†–ê                                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ   –ö–∞–º–µ—Ä–∞ –§–í     ‚îÇ  ‚îÇ Flussonic Agent ‚îÇ  ‚îÇ   SquashFS –§–°   ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   (–≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è)  ‚îÇ‚óÑ‚îÄ‚î§   (–±–∏–Ω–∞—Ä–Ω–∏–∫)    ‚îÇ‚îÄ‚ñ∫‚îÇ   (read-only)   ‚îÇ ‚îÇ
‚îÇ  ‚îÇ                 ‚îÇ  ‚îÇ                 ‚îÇ  ‚îÇ                 ‚îÇ ‚îÇ
‚îÇ  ‚îÇ - RTSP Server   ‚îÇ  ‚îÇ - Tunnel client ‚îÇ  ‚îÇ - /usr/bin/     ‚îÇ ‚îÇ
‚îÇ  ‚îÇ - H.264/H.265   ‚îÇ  ‚îÇ - P2P support   ‚îÇ  ‚îÇ - /etc/         ‚îÇ ‚îÇ
‚îÇ  ‚îÇ - Local access  ‚îÇ  ‚îÇ - Auto-start    ‚îÇ  ‚îÇ - /opt/         ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã:

1. **–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–∞–º–µ—Ä—ã:**
   ```
   Systemd/init.d ‚Üí –ó–∞–ø—É—Å–∫ Flussonic Agent
   ```

2. **–ê–≥–µ–Ω—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è:**
   ```
   - –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ /etc/ –∏–ª–∏ /mnt/mtd/
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ RTSP –ø–æ—Ç–æ–∫–∞
   - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Flussonic Watcher —Å–µ—Ä–≤–µ—Ä—É
   ```

3. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç—É–Ω–Ω–µ–ª—è:**
   ```
   - WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ID
   - –°–æ–∑–¥–∞–Ω–∏–µ TCP —Ç—É–Ω–Ω–µ–ª—è –¥–ª—è RTSP
   ```

4. **–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
   ```
   - –ö–∞–º–µ—Ä–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –∫–∞–∫ 127.0.0.1:8554
   - Flussonic Watcher –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
   - –ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å RTSP
   ```

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã Linux/WSL:

```bash
# –í WSL/Linux
sudo apt-get install squashfs-tools binutils file strings

# –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ SquashFS
unsquashfs romfs-x.squashfs.img

# –†–µ–∑—É–ª—å—Ç–∞—Ç –≤ squashfs-root/
cd squashfs-root/

# –ü–æ–∏—Å–∫ Flussonic Agent
find . -name "*flussonic*" -o -name "*agent*"
find . -type f -executable | xargs file | grep ELF

# –ê–Ω–∞–ª–∏–∑ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞
file /path/to/agent
strings /path/to/agent | grep -i "tunnel\|websocket\|p2p"
objdump -d /path/to/agent > agent_disasm.txt
```

## üìã –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω–æ–π –§–°

### 1. **–ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –∞–≥–µ–Ω—Ç–∞:**
```bash
find . -name "*agent*" -type f -executable
```

### 2. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
```bash
find . -name "*.json" -o -name "*.conf" | grep -i flussonic
```

### 3. **Startup —Å–∫—Ä–∏–ø—Ç—ã:**
```bash
find ./etc/init.d/ -name "*flussonic*"
find ./etc/systemd/system/ -name "*agent*"
```

### 4. **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:**
```bash
find . -name "*.so" | grep -i "tunnel\|flussonic"
```

## üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Ö–æ–¥–æ–∫ –∫ –Ω–∞—à–µ–º—É –∞–≥–µ–Ω—Ç—É

### –ü–æ—Å–ª–µ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞:

1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞:**
   - –ò–∑—É—á–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∞–≥–µ–Ω—Ç–∞
   - –ü–æ–Ω—è—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
   - –ù–∞–π—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

2. **–ü—Ä–æ—Ç–æ–∫–æ–ª —Ç—É–Ω–Ω–µ–ª—è:**
   - –ü–æ–Ω—è—Ç—å —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π
   - –ò–∑—É—á–∏—Ç—å heartbeat –ø—Ä–æ—Ç–æ–∫–æ–ª
   - –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–∞–º–µ—Ä–æ–π:**
   - –ö–∞–∫ –∞–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç RTSP –ø–æ—Ç–æ–∫
   - –ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–º–µ—Ä—ã
   - –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—à–µ–≥–æ –∞–≥–µ–Ω—Ç–∞:**
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª
   - –î–æ–±–∞–≤–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Flussonic
   - –£–ª—É—á—à–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø–æ–ª–Ω–æ–≥–æ reverse engineering:

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ WSL**:
   ```powershell
   wsl --install
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**:
   ```bash
   sudo apt-get update
   sudo apt-get install squashfs-tools binutils file
   ```

3. **–†–∞—Å–ø–∞–∫—É–π—Ç–µ SquashFS**:
   ```bash
   cd /mnt/c/Users/King/Desktop/Dahua/firmware_extracted/manual_extract
   unsquashfs romfs-x.squashfs.img
   ```

4. **–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ**:
   ```bash
   cd squashfs-root
   find . -name "*agent*"
   strings agent_binary > analysis.txt
   ```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–Ω–ª–∞–π–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏–ª–∏ Linux LiveUSB –¥–ª—è —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞.

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å SquashFS** –≤ Linux/WSL
2. **–ù–∞–π—Ç–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª** Flussonic Agent
3. **–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å strings** –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
4. **–ò–∑—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é** –∞–≥–µ–Ω—Ç–∞
5. **–û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—à –∞–≥–µ–Ω—Ç** –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞—Ö–æ–¥–æ–∫
6. **–°–æ–∑–¥–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é** —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é

---

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: Reverse engineering –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ª–∏—Ü–µ–Ω–∑–∏–æ–Ω–Ω—ã–º–∏ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è–º–∏ –∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.
